
namespace = honor_leader

country_event = { # All - on_ruler_set - Set Reign Begin Date Flags
	id = honor_leader.1000
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_regular_empire = yes
	}

	immediate = { # Consider adding event that lets you set term start date for auths
		if = {
			limit = { ruler = { NOT = { is_variable_set = stints_as_ruler } } } # In case of authority switches
			ruler = {
				set_variable = { which = stints_as_ruler value = 1 }
				get_ruler_term_begin_number = yes
			}
			if = {
				limit = { days_passed < 2 }
				ruler = { set_leader_flag = first_ruler }
			}
		}
		else = {
			ruler = {
				change_variable = { which = stints_as_ruler value = 1 }
				get_ruler_term_begin_number = yes
			}
		}
	}
}

# Executed when a ruler has been removed
# From = Previous Ruler
# This = Country
country_event = { # ALL - on_ruler_back_to_pre_ruler_class - Set Reign End Date Flags
	id = honor_leader.1010
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_regular_empire = yes
	}

	immediate = {
		from = { get_ruler_term_end_number = yes }
	}
}

country_event = { # ALL - on_election_ended - Set Reign End Date Flag for first ruler
	id = honor_leader.1015
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_regular_empire = yes
		ruler = { NOT = { has_leader_flag = first_ruler } }
		any_owned_leader = { has_leader_flag = first_ruler }
	}

	immediate = {
		random_owned_leader = {
			limit = { has_leader_flag = first_ruler }
			remove_leader_flag = first_ruler
			set_saved_date = {
				key = ruler_stint_end_date_1
				days_from_present = 0
			}
		}
	}
}

# Executed just as country is changing its government, before the new one is applied
# THIS = country
country_event = { # ALL - on_post_government_changed - Reset Stints
	id = honor_leader.1100
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_regular_empire = yes
		exists = ruler
	}

	immediate = {
		ruler = { subtract_variable = { which = stints_as_ruler value = 1 } }
	}
}

country_event = { # ALL - on_monthly_pulse_country - Set months as Ruler
	id = honor_leader.1200
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_ai = no
		is_regular_empire = yes
		exists = ruler
	}

	immediate = {
		if = {
			limit = { ruler = { NOT = { is_variable_set = months_as_ruler } } }
			ruler = { set_variable = { which = months_as_ruler value = 1 } }
		}
		else = {
			ruler = { change_variable = { which = months_as_ruler value = 1 } }
		}
		
	}
}