namespace = honor_leader

# on_leader_death - save event and if possible determine leader death
country_event = {
	id = honor_leader.2000
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		is_ai = no
		exists = from
		from = {
			is_scope_valid = yes
			is_scope_type = leader
			is_fake_leader = no
			leader_age > 1
			is_owned_by = root
		}
	}
	immediate = {
		log = "2000 HAPP"
		set_update_modifiers_batch = begin
		# from = { save_event_target_as = honor_leader }
		from = {
			save_event_target_as = honor_leader
			export_trigger_value_to_variable = {
				trigger = has_level
				variable = dead_leader_level
			}
			log = "FROM IS: [this.GetName]"
		}
		event_target:honor_copy_@from = {
			log = "COPY GOT: [this.GetName]"
			save_event_target_as = honor_leader_clone
			honor_leader_copy_flags_and_vars = yes
			set_saved_date = {
				key = leader_death_fired_date
				days_from_present = 0
			}
			set_variable = { which = dead_leader_level value = event_target:honor_leader.dead_leader_level }
			if = {
				limit = { is_variable_set = months_as_ruler }
				divide_variable = { which = months_as_ruler value = 12 }
				round_variable = months_as_ruler
				if = {
					limit = { check_variable = { which = months_as_ruler value < 1 } }
					set_variable = { which = months_as_ruler value = 0 }
				}
			}
			if = {
				limit = { leader_class = ruler }
				get_ruler_term_end_number = yes
			}
			if = {
				limit = { root = { NOT = { has_country_flag = honor_popup_disabled } } }
				root = { country_event = { id = honor_leader.200 } }
			}
			else = {
				# SAVE LEADER HERE FOR LATER.
				honor_leader_save_leader = yes
				root = {
					every_owned_leader = { remove_leader_flag = honor_leader_has_been_viewed }
					every_owned_leader = {
						limit = { has_leader_flag = honor_leader_interim_leader }
						# Civil Wars compat flag
						set_leader_flag = dead_ruler
						kill_leader = { show_notification = no }
					}
				}
			}
		}
		# FUNE: From what I can tell, this is looking for a scope that doesnt exist
		# from = {
		# 	if = { limit = { exists = from }
		# 		from = {
		# 			if = {
		# 				limit = {
		# 					is_scope_valid = yes
		# 					OR = {
		# 						is_scope_type = ship
		# 						is_scope_type = fleet
		# 						is_scope_type = country
		# 						is_scope_type = leader
		# 						is_scope_type = galactic_object
		# 						is_scope_type = planet
		# 						is_scope_type = army
		# 					}
		# 				}
		# 				save_event_target_as = honor_leader_cause_of_death
		# 				# "Cause of Death Scope" if on fleet this is exact same as the leader??
		# 				#  log = "honor_leader_cause_of_death: \\[honor_leader_cause_of_death.GetName] Scope: \\[honor_leader_cause_of_death.GetScopeType]"
		# 			}
		# 		}
		# 		# TODO: to much resources?
		# 		# if = { limit = { exists = fleet }
		# 		# 	set_leader_flag = leader_on_fleet
		# 		# 	fleet = {
		# 		# 		if = { limit = { exists = solar_system }
		# 		# 			solar_system = { save_event_target_as = honor_leader_system }
		# 		# 		}
		# 		# 	}
		# 		# }
		# 	}
		# 	prev = { save_event_target_as = honor_leader_country }
		# 	# if = { limit = { gender = female }
		# 	# 	set_variable = { which = honor_leader_gender value = 1 }
		# 	# } else = { # indeterminable still not used
		# 	# 	set_variable = { which = honor_leader_gender value = 2 }
		# 	# }
		# 	# export_trigger_value_to_variable = { trigger = has_skill variable = honor_leader_skill }
		# 	if = {
		# 		limit = {
		# 			NOR = {
		# 				has_leader_flag = honor_leader_ruler_in_election
		# 				exists = event_target:honor_leader_clone
		# 			}
		# 		}
		# 		# Clone current leader and set to honor_leader - for Old Age death trigger.
		# 		# Add time effects if not dead.
		# 		switch = {
		# 			trigger = leader_class
		# 			ruler = {
		# 				if = { limit = { NOT = { has_leader_flag = honor_leader_dead_leader } }
		# 					set_variable = { which = honor_leader_calender_year value = owner.honor_leader_calender_year }
		# 					set_variable = { which = honor_leader_office_end value = honor_leader_calender_year }
		# 					set_variable = { which = honor_leader_class value = 1 }
		# 					root = {
		# 						create_leader = {
		# 							class = ruler
		# 							species = prev.species
		# 							name = "NAME"
		# 							skill = 1
		# 							# traits = { trait = trait_ruler_eye_for_talent }
		# 							traits = { trait = leader_trait_resilient }
		# 							gender = male
		# 							set_age = 21
		# 							effect = {
		# 								set_variable = { which = honor_leader_class value = 1 }
		# 								save_event_target_as = honor_leader_clone
		# 								honor_leader_copy_flags_and_vars = yes # Copy Vars and flags
		# 								leader_event = { id = honor_leader.200 days = -1 }
		# 							}
		# 						}
		# 					}
		# 				}
		# 			}
		# 			governor = {
		# 				set_variable = { which = honor_leader_class value = 2 }
		# 				root = {
		# 					create_leader = {
		# 						class = governor
		# 						species = prev.species
		# 						name = "NAME"
		# 						skill = 1
		# 						traits = { trait = leader_trait_resilient }
		# 						gender = male
		# 						set_age = 21
		# 						effect = {
		# 							set_variable = { which = honor_leader_class value = 2 }
		# 							save_event_target_as = honor_leader_clone
		# 							honor_leader_copy_flags_and_vars = yes # Copy Vars and flags
		# 							leader_event = { id = honor_leader.200 days = -1 }
		# 						}
		# 					}
		# 				}
		# 			}
		# 			scientist = {
		# 				set_variable = { which = honor_leader_class value = 3 }
		# 				root = {
		# 					create_leader = {
		# 						class = scientist
		# 						species = prev.species
		# 						name = "NAME"
		# 						skill = 1
		# 						traits = { trait = leader_trait_resilient }
		# 						gender = male
		# 						set_age = 21
		# 						effect = {
		# 							set_variable = { which = honor_leader_class value = 3 }
		# 							save_event_target_as = honor_leader_clone
		# 							honor_leader_copy_flags_and_vars = yes # Copy Vars and flags
		# 							leader_event = { id = honor_leader.200 days = -1 }
		# 						}
		# 					}
		# 				}
		# 			}
		# 			admiral = {
		# 				set_variable = { which = honor_leader_class value = 4 }
		# 				root = {
		# 					create_leader = {
		# 						class = admiral
		# 						species = prev.species
		# 						name = "NAME"
		# 						skill = 1
		# 						traits = { trait = leader_trait_resilient }
		# 						gender = male
		# 						set_age = 21
		# 						effect = {
		# 							set_variable = { which = honor_leader_class value = 4 }
		# 							save_event_target_as = honor_leader_clone
		# 							honor_leader_copy_flags_and_vars = yes # Copy Vars and flags
		# 							leader_event = { id = honor_leader.200 days = -1 }
		# 						}
		# 					}
		# 				}
		# 			}
		# 			general = {
		# 				set_variable = { which = honor_leader_class value = 5 }
		# 				root = {
		# 					create_leader = {
		# 						class = general
		# 						species = prev.species
		# 						name = "NAME"
		# 						skill = 1
		# 						traits = { trait = leader_trait_resilient }
		# 						gender = male
		# 						set_age = 21
		# 						effect = {
		# 							set_variable = { which = honor_leader_class value = 5 }
		# 							save_event_target_as = honor_leader_clone
		# 							honor_leader_copy_flags_and_vars = yes # Copy Vars and flags
		# 							leader_event = { id = honor_leader.200 days = -1 }
		# 						}
		# 					}
		# 				}
		# 			}
		# 		}
		# 	}
		# 	else_if = {
		# 		limit = {
		# 			# has_leader_flag = honor_leader_ruler_in_election
		# 			has_leader_flag = honor_leader_ruler_starting_ruler
		# 			NOT = { exists = event_target:honor_leader_clone }
		# 		}
		# 		# Clone current leader and set to honor_leader - for Starting ruler losing election - become governor
		# 		# Add time effects if not dead.
		# 		if = {
		# 			limit = {
		# 				leader_class = ruler
		# 				NOT = { has_leader_flag = honor_leader_dead_leader }
		# 			}
		# 			set_variable = { which = honor_leader_calender_year value = owner.honor_leader_calender_year }
		# 			set_variable = { which = honor_leader_office_end value = honor_leader_calender_year }
		# 		}
		# 		root = {
		# 			create_leader = {
		# 				class = governor
		# 				species = prev.species
		# 				name = "NAME"
		# 				skill = 1
		# 				traits = { trait = random_trait }
		# 				gender = male
		# 				set_age = 28
		# 				effect = {
		# 					set_leader_flag = honor_leader_was_ruler # Was Ruler Flag
		# 					honor_leader_copy_flags_and_vars = yes # Copy Vars and flags
		# 					honor_leader_add_traits = yes # Add Traits
		# 					# Remove unnessesary flags and traits.
		# 					remove_trait = leader_trait_trickster
		# 					remove_leader_flag = honor_leader_is_pool_leader
		# 					# save_event_target_as = honor_leader
		# 					save_event_target_as = honor_leader_clone
		# 					# leader_event = { id = honor_leader.200 }
		# 				}
		# 			}
		# 		}
		# 	}
		# 	if = {
		# 		limit = {
		# 			exists = event_target:honor_leader_clone
		# 			event_target:honor_leader_clone = { is_scope_valid = yes is_scope_type = leader }
		# 			exists = last_created_leader
		# 			last_created_leader = { is_same_value = event_target:honor_leader_clone }
		# 			# NOT = { has_active_event = { honor_leader.200 } }
		# 		}
		# 		event_target:honor_leader_clone = {
		# 			# save_event_target_as = honor_leader_clone
		# 			# log="Class [This.honor_leader_class]"
		# 			# Remove for empty trait set.
		# 			remove_trait = leader_trait_resilient
		# 			# Dead Leader Flags
		# 			set_leader_flag = honor_leader_dead_leader
		# 			set_leader_flag = honor_leader_interim_leader
		# 			# Add Traitss
		# 			honor_leader_add_traits = yes
		# 			if = {
		# 				limit = {
		# 					NAND = {
		# 						exists = event_target:honor_leader
		# 						event_target:honor_leader = { is_scope_valid = yes is_scope_type = leader }
		# 					}
		# 				}
		# 				save_event_target_as = honor_leader
		# 			}
		# 		}
		# 	}
		# }

		set_update_modifiers_batch = end
	}
	after = {
		if = {
			limit = {
				exists = event_target:honor_leader_clone
				event_target:honor_leader_clone = { is_scope_valid = yes is_scope_type = leader }
				exists = last_created_leader
				last_created_leader = { is_same_value = event_target:honor_leader_clone }
			}
			event_target:honor_leader_clone = {
				# log="Class [This.honor_leader_class]"
				# leader_event = { id = honor_leader.200 days = -1 }
				# Remove for empty trait set.
				remove_trait = leader_trait_resilient
				# Dead Leader Flags
				set_leader_flag = honor_leader_dead_leader
				set_leader_flag = honor_leader_interim_leader
				# Add Traitss
				honor_leader_add_traits = yes
				save_event_target_as = honor_leader
			}
		}
	}
}

# Event on Leader death
# Scope = root
# From = owner = honor_leader_country
# leader_event = {
country_event = {
	id = honor_leader.200
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 1 }
			}
		}
		text = honor_leader.200.desc.deadruler_1
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 2 }
			}
		}
		text = honor_leader.200.desc.deadruler_2
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 3 }
			}
		}
		text = honor_leader.200.desc.deadruler_3
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 4 }
			}
		}
		text = honor_leader.200.desc.deadruler_4
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 5 }
			}
		}
		text = honor_leader.200.desc.deadruler_5
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 6 }
			}
		}
		text = honor_leader.200.desc.deadruler_6
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 7 }
			}
		}
		text = honor_leader.200.desc.deadruler_7
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 8 }
			}
		}
		text = honor_leader.200.desc.deadruler_8
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 9 }
			}
		}
		text = honor_leader.200.desc.deadruler_9
	}
	desc = {
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 10 }
			}
		}
		text = honor_leader.200.desc.deadruler_10
	}
	desc = {
		# trigger = { leader_class = governor }
		trigger = {
			event_target:honor_leader_clone = {
				NOR = {
					pre_ruler_leader_class = scientist
					pre_ruler_leader_class = admiral
					pre_ruler_leader_class = general
					is_variable_set = stints_as_ruler
				}
			}
		}
		text = honor_leader.200.desc.deadgovernor
	}
	desc = {
		# trigger = { leader_class = scientist }
		trigger = {
			event_target:honor_leader_clone = {
				pre_ruler_leader_class = scientist
				NOT = { is_variable_set = stints_as_ruler }
			}
		}
		text = honor_leader.200.desc.deadscientist
	}
	desc = {
		# trigger = { leader_class = admiral }
		trigger = {
			event_target:honor_leader_clone = {
				pre_ruler_leader_class = admiral
				NOT = { is_variable_set = stints_as_ruler }
			}
		}
		text = honor_leader.200.desc.deadadmiral
	}
	desc = {
		# trigger = { leader_class = general }
		trigger = {
			event_target:honor_leader_clone = {
				pre_ruler_leader_class = general
				NOT = { is_variable_set = stints_as_ruler }
			}
		}
		text = honor_leader.200.desc.deadgeneral
	}
	title = "honor_leader.103.title"
	diplomatic = yes
	picture_event_data = {
		# portrait = event_target:honor_leader_clone
		portrait = event_target:honor_leader_clone
		planet_background = root.capital_scope
		graphical_culture = root
		city_level = root.capital_scope
		room = root
	}
	show_sound = event_life_support_fail
	is_triggered_only = yes
	# trigger = { is_scope_type = leader }
	immediate = {
		# from = {
		# 	save_event_target_as = honor_leader_country
		# 	log = "Honor Leader - IN death event 200"
		# 	log = "honor_leader: [honor_leader.GetName]"
		# 	log = "honor_leader: [honor_leader.GetScopeType]"
		# 	log = "honor_leader: [honor_leader.honor_leader_years_of_service]"
		# 	log = "This: [This.GetName]"
		# 	log = "ThisScope: [This.GetScopeType]"
		# 	log = "ThisYears: [This.honor_leader_years_of_service]"
		# 	log = "From: [From.GetName]"
		# 	log = "FromScope: [From.GetScopeType]"
		# 	log = "FromYears: [From.honor_leader_years_of_service]"
		# 	log = "FromFrom: [From.From.GetName]"
		# 	log = "FromFromScope: [From.From.GetScopeType]"
		# 	log = "FromFromYears: [From.From.honor_leader_years_of_service]"
		# 	log = "Cause of Death Scope"
		# 	log = "honor_leader_cause_of_death: [honor_leader_cause_of_death.GetName]"
		# 	log = "honor_leader_cause_of_deathScope: [honor_leader_cause_of_death.GetScopeType]"
		# }
	}
	option = {
		name = "honor_leader.103.honored"
		custom_tooltip = honor_leader.103.honored.tooltip
		trigger = { is_scope_valid = yes }
		allow = {
			resource_stockpile_compare = { resource = influence value >= 75 }
			# resource_stockpile_compare = { resource = unity value >= ?? }
		}
		add_resource = { influence = -75 }
		hidden_effect = {
			play_sound = event_celebration
			save_event_target_as = honor_leader_country
			if = {
				limit = { NOT = { has_country_flag = honor_leader_disable_renaming } }
				if = {
					limit = {
						event_target:honor_leader = {
							OR = {
								leader_class = ruler
								has_leader_flag = honor_leader_was_ruler
							}
						}
					}
					# Rename entire system after ruler - credit to https://steamcommunity.com/sharedfiles/filedetails/?id=1323820517 for original implementation via planet edict
					random_system_within_border = {
						limit = {
							starting_system = no
							is_capital_system = no
							NOT = { has_star_flag = honor_leader_renamed }
						}
						starbase = {
							fleet = {
								random_owned_ship = {
									limit = { is_ship_class = shipclass_starbase }
									set_name = "honor_leader.Rename_starbase"
								}
								set_name = "honor_leader.Rename_starbase"
							}
						}
						hidden_effect = {
							set_name = root
							set_star_flag = honor_leader_renamed
							set_variable = { which = honor_leader_stars value = 0 }
							# Errors thown on galactic_object for the stars are fine since stars count as planet and galactic_object scopes.
							every_system_planet = {
								limit = { is_star = yes }
								prev = {
									change_variable = { which = honor_leader_stars value = 1 }
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_stars value = 2 }
										}
									}
									set_name = "[PREV.GetName] B"
									set_planet_flag = honor_leader_renamed
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_stars value = 3 }
										}
									}
									set_name = "[PREV.GetName] C"
									set_planet_flag = honor_leader_renamed
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
							}
							every_system_planet = {
								limit = {
									is_star = yes
									NOT = { has_planet_flag = honor_leader_renamed }
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_stars value >= 2 }
										}
									}
									set_name = "[PREV.GetName] A"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								else = {
									set_name = "[PREV.GetName]"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
							}
							every_system_planet = {
								limit = {
									is_star = yes
									has_moon = yes
								}
								prev = {
									set_variable = { which = honor_leader_planets value = 0 }
								}
								every_moon = {
									limit = {
										is_asteroid = no
										is_artificial = no
									}
									prevprev = {
										change_variable = { which = honor_leader_planets value = 1 }
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 1 }
											}
										}
										set_name = "[PREV.GetName] I"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 2 }
											}
										}
										set_name = "[PREV.GetName] II"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 3 }
											}
										}
										set_name = "[PREV.GetName] III"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 4 }
											}
										}
										set_name = "[PREV.GetName] IV"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 5 }
											}
										}
										set_name = "[PREV.GetName] V"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 6 }
											}
										}
										set_name = "[PREV.GetName] VI"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 7 }
											}
										}
										set_name = "[PREV.GetName] VII"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 8 }
											}
										}
										set_name = "[PREV.GetName] VIII"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 9 }
											}
										}
										set_name = "[PREV.GetName] IX"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_planets value = 10 }
											}
										}
										set_name = "[PREV.GetName] X"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									set_planet_flag = honor_leader_renamed
									prevprev = {
										set_variable = { which = honor_leader_moons value = 0 }
									}
									every_moon = {
										limit = {
											is_asteroid = no
											is_artificial = no
										}
										prevprevprev = {
											change_variable = { which = honor_leader_moons value = 1 }
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 1 }
												}
											}
											set_name = "[PREV.GetName]a"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 2 }
												}
											}
											set_name = "[PREV.GetName]b"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 3 }
												}
											}
											set_name = "[PREV.GetName]c"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 4 }
												}
											}
											set_name = "[PREV.GetName]d"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 5 }
												}
											}
											set_name = "[PREV.GetName]e"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 6 }
												}
											}
											set_name = "[PREV.GetName]f"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 7 }
												}
											}
											set_name = "[PREV.GetName]g"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 8 }
												}
											}
											set_name = "[PREV.GetName]h"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 9 }
												}
											}
											set_name = "[PREV.GetName]i"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										if = {
											limit = {
												prevprevprev = {
													check_variable = { which = honor_leader_moons value = 10 }
												}
											}
											set_name = "[PREV.GetName]j"
											if = {
												limit = { has_mining_station = yes }
												mining_station = {
													set_name = "honor_leader.Rename_mining"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_research_station = yes }
												research_station = {
													set_name = "honor_leader.Rename_research"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
										set_planet_flag = honor_leader_renamed
									}
								}
							}
							set_variable = { which = honor_leader_planets value = 0 }
							every_system_planet = {
								limit = {
									is_asteroid = no
									is_star = no
									is_moon = no
									is_artificial = no
									NOT = { has_planet_flag = honor_leader_renamed }
								}
								prev = {
									change_variable = { which = honor_leader_planets value = 1 }
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 1 }
										}
									}
									set_name = "[PREV.GetName] I"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 2 }
										}
									}
									set_name = "[PREV.GetName] II"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 3 }
										}
									}
									set_name = "[PREV.GetName] III"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 4 }
										}
									}
									set_name = "[PREV.GetName] IV"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 5 }
										}
									}
									set_name = "[PREV.GetName] V"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 6 }
										}
									}
									set_name = "[PREV.GetName] VI"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 7 }
										}
									}
									set_name = "[PREV.GetName] VII"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 8 }
										}
									}
									set_name = "[PREV.GetName] VIII"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 9 }
										}
									}
									set_name = "[PREV.GetName] IX"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								if = {
									limit = {
										prev = {
											check_variable = { which = honor_leader_planets value = 10 }
										}
									}
									set_name = "[PREV.GetName] X"
									if = {
										limit = { has_mining_station = yes }
										mining_station = {
											set_name = "honor_leader.Rename_mining"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_research_station = yes }
										research_station = {
											set_name = "honor_leader.Rename_research"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
									if = {
										limit = { has_observation_outpost = yes }
										observation_outpost = {
											set_name = "honor_leader.Rename_observation"
											random_owned_ship = { set_name = "[PREV.GetName]" }
										}
									}
								}
								set_planet_flag = honor_leader_renamed
								prev = {
									set_variable = { which = honor_leader_moons value = 0 }
								}
								every_moon = {
									limit = {
										is_asteroid = no
										is_artificial = no
									}
									prevprev = {
										change_variable = { which = honor_leader_moons value = 1 }
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_moons value = 1 }
											}
										}
										set_name = "[PREV.GetName]a"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
											if = {
												limit = { has_observation_outpost = yes }
												observation_outpost = {
													set_name = "honor_leader.Rename_observation"
													random_owned_ship = { set_name = "[PREV.GetName]" }
												}
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_moons value = 2 }
											}
										}
										set_name = "[PREV.GetName]b"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_moons value = 3 }
											}
										}
										set_name = "[PREV.GetName]c"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_moons value = 4 }
											}
										}
										set_name = "[PREV.GetName]d"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_moons value = 5 }
											}
										}
										set_name = "[PREV.GetName]e"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_moons value = 6 }
											}
										}
										set_name = "[PREV.GetName]f"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									if = {
										limit = {
											prevprev = {
												check_variable = { which = honor_leader_moons value = 7 }
											}
										}
										set_name = "[PREV.GetName]g"
										if = {
											limit = { has_mining_station = yes }
											mining_station = {
												set_name = "honor_leader.Rename_mining"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_research_station = yes }
											research_station = {
												set_name = "honor_leader.Rename_research"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
										if = {
											limit = { has_observation_outpost = yes }
											observation_outpost = {
												set_name = "honor_leader.Rename_observation"
												random_owned_ship = { set_name = "[PREV.GetName]" }
											}
										}
									}
									set_planet_flag = honor_leader_renamed
								}
							}
							every_system_planet = {
								limit = {
									NOR = {
										merg_is_habitat = yes
										is_planet_class = pc_habitat_shielded
									}
								}
								every_moon = {
									limit = {
										OR = {
											merg_is_habitat = yes
											is_planet_class = pc_habitat_shielded
										}
									}
									set_name = "honor_leader.Rename_colony"
								}
							}
						}
					}
					random_owned_ship = {
						limit = {
							NOT = { has_ship_flag = honor_leader_renamed }
							OR = {
								is_ship_size = corvette
								is_ship_size = destroyer
								is_ship_size = cruiser
								is_ship_size = battleship
								is_ship_size = titan
							}
						}
						set_ship_flag = honor_leader_renamed
						set_name = "honor_leader.Rename_ship"
					}
				}
				if = {
					limit = { event_target:honor_leader = { leader_class = governor } }
					random_owned_planet = {
						limit = {
							NOT = { has_planet_flag = honor_leader_renamed }
							is_homeworld = no
						}
						set_planet_flag = honor_leader_renamed
						set_name = event_target:honor_leader
					}
					random_owned_ship = {
						limit = {
							NOT = { has_ship_flag = honor_leader_renamed }
							OR = {
								is_ship_size = colonizer
								is_ship_size = sponsored_colonizer
								is_ship_size = constructor
							}
						}
						set_ship_flag = honor_leader_renamed
						set_name = "honor_leader.Rename_ship"
					}
				}
				if = {
					limit = { event_target:honor_leader = { leader_class = scientist } }
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = honor_leader_renamed }
						}
						random_system_planet = {
							limit = {
								NOT = { has_planet_flag = honor_leader_renamed }
								is_homeworld = no
							}
							set_planet_flag = honor_leader_renamed
							set_name = root
						}
					}
					random_owned_ship = {
						limit = {
							NOT = { has_ship_flag = honor_leader_renamed }
							OR = {
								is_ship_size = science
								is_ship_size = constructor
							}
						}
						set_ship_flag = honor_leader_renamed
						set_name = "honor_leader.Rename_ship"
					}
				}
				if = {
					limit = { event_target:honor_leader = { leader_class = admiral } }
					random_owned_fleet = {
						limit = {
							NOT = { has_fleet_flag = honor_leader_renamed }
							num_ships > 1
							fleet_size > 1
						}
						set_fleet_flag = honor_leader_renamed
						set_name = "honor_leader.Rename_fleet"
					}
					random_owned_ship = {
						limit = {
							NOT = { has_ship_flag = honor_leader_renamed }
							OR = {
								is_ship_size = corvette
								is_ship_size = destroyer
								is_ship_size = cruiser
								is_ship_size = battleship
							}
						}
						set_ship_flag = honor_leader_renamed
						set_name = "honor_leader.Rename_ship"
					}
				}
				if = {
					limit = { event_target:honor_leader = { leader_class = general } }
					random_owned_army = { set_name = "honor_leader.Rename_fleet" }
					random_owned_ship = {
						limit = {
							NOT = { has_ship_flag = honor_leader_renamed }
							OR = {
								is_ship_size = corvette
								is_ship_size = destroyer
								is_ship_size = cruiser
								is_ship_size = battleship
							}
						}
						set_ship_flag = honor_leader_renamed
						set_name = "honor_leader.Rename_ship"
					}
				}
			}
			if = {
				limit = { NOT = { has_country_flag = honor_leader_disable_bonus } }
				honor_leader_honor_leader = yes
			}

			# SAVE LEADER HERE FOR LATER.
			event_target:honor_leader_clone = { honor_leader_save_leader = yes }
			every_owned_leader = { remove_leader_flag = honor_leader_has_been_viewed }
			every_owned_leader = {
				limit = { has_leader_flag = honor_leader_interim_leader }
				# Civil Wars compat flag
				set_leader_flag = dead_ruler
				kill_leader = { show_notification = no }
			}
		}
	}
	option = {
		name = "honor_leader.103.notherhim"
		custom_tooltip = honor_leader.103.notherhim.tooltip
		trigger = { is_scope_valid = yes }
		hidden_effect = {
			event_target:honor_leader_country = {
				# SAVE LEADER HERE FOR LATER.
				event_target:honor_leader = { honor_leader_save_leader = yes }
				every_owned_leader = { remove_leader_flag = honor_leader_has_been_viewed }
				every_owned_leader = {
					limit = { has_leader_flag = honor_leader_interim_leader is_fake_leader = yes }
					# Civil Wars compat flag
					kill_leader = { show_notification = no }
				}
			}
		}
	}
	option = {
		name = "honor_leader.103.notherhimremove"
		custom_tooltip = honor_leader.103.notherhimremove.tooltip
		# DON'T SAVE AND CARRY ON.
		every_owned_leader = { remove_leader_flag = honor_leader_has_been_viewed }
		every_owned_leader = {
			limit = { has_leader_flag = honor_leader_interim_leader }
			# Civil Wars compat flag
			set_leader_flag = dead_ruler
			kill_leader = { show_notification = no }
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_1"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 1 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_2"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 2 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_3"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 3 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_4"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 4 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_5"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 5 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_6"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 6 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_7"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 7 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_8"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 8 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_9"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 9 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage1"
		response_text = "honor_leader.200.desc.deadruler_10"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value = 10 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage2"
		response_text = "honor_leader.200.desc.deadrulerpage2"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value >= 1 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage3"
		response_text = "honor_leader.200.desc.deadrulerpage3"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value >= 1 }
			}
		}
	}
	option = {
		name = "honor_leader.111.rulerpage4"
		response_text = "honor_leader.200.desc.deadrulerpage4"
		is_dialog_only = yes
		trigger = {
			event_target:honor_leader_clone = {
				check_variable = { which = stints_as_ruler value >= 1 }
			}
		}
	}
}

# Disable Renaming edict- open dialog
country_event = {
	id = honor_leader.3000
	desc = "honor_leader.3000.desc"
	title = "honor_leader.3000.title"
	picture = "GFX_evt_unity_symbol"
	is_triggered_only = yes
	option = {
		trigger = { NOT = { has_country_flag = honor_popup_disabled } }
		name = "honor_leader.3000.popups"
		set_country_flag = honor_popup_disabled
	}
	option = {
		trigger = { has_country_flag = honor_popup_disabled }
		name = "honor_leader.3000.nopopups"
		remove_country_flag = honor_popup_disabled
	}
	option = {
		trigger = {
			NOT = { has_country_flag = honor_leader_disable_renaming }
		}
		name = "honor_leader.3000.disablerenaming"
		set_country_flag = honor_leader_disable_renaming
	}
	option = {
		trigger = { has_country_flag = honor_leader_disable_renaming }
		name = "honor_leader.3000.enablerenaming"
		remove_country_flag = honor_leader_disable_renaming
	}
	option = {
		trigger = {
			NOT = { has_country_flag = honor_leader_disable_bonus }
		}
		name = "honor_leader.3000.disablebonus"
		set_country_flag = honor_leader_disable_bonus
	}
	option = {
		trigger = { has_country_flag = honor_leader_disable_bonus }
		name = "honor_leader.3000.enablebonus"
		remove_country_flag = honor_leader_disable_bonus
	}
	option = {
		name = "honor_leader.3000.resetmemorials"
		hidden_effect = {
			# honor_leader_honor_leader_memorial_reset = yes
			# RESET CODE	for Memorials - removes ALL megastructures and modifiers
			reset_memorials_effect = yes
		}
	}
	option = { name = "honor_leader.110.nope" }
}

country_event = {
	id = honor_leader.9000
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		random_owned_leader = {
			limit = { NOT = { leader_class = ruler } }
			set_leader_flag = test_kill_leader
			save_event_target_as = clone_target
		}
		clone_leader = {
			target = event_target:clone_target
			effect = {
				save_global_event_target_as = clone_target_@event_target:clone_target
				set_immortal = yes
				exile_leader_as = clone_leader_test
				log = "NAME: [this.GetName]"
			}
		}
	}
}

country_event = {
	id = honor_leader.9010
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		random_owned_leader = {
			limit = { has_leader_flag = test_kill_leader }
			save_event_target_as = test_kill_target
			event_target:clone_target_@this = {
				log = "SUCCESS, FOUND: [this.GetName] == 1"
			}
		}
		event_target:clone_target_@event_target:test_kill_target = {
			log = "SUCCESS, FOUND: [this.GetName] == 2"
		}
	}
}
